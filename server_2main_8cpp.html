<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WinUDPShardedEcho: src/server/main.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">WinUDPShardedEcho<span id="projectnumber">&#160;main</span>
   </div>
   <div id="projectbrief">A reference implementation of a highly scalable Windows UDP echo server using Winsock + IOCP with SIO_CPU_AFFINITY and one worker thread per CPU to align NIC RSS</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('server_2main_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">main.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Scalable UDP echo server.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;chrono&gt;</code><br />
<code>#include &lt;csignal&gt;</code><br />
<code>#include &lt;cstdlib&gt;</code><br />
<code>#include &lt;format&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;numeric&gt;</code><br />
<code>#include &lt;syncstream&gt;</code><br />
<code>#include &lt;thread&gt;</code><br />
<code>#include &quot;<a class="el" href="arg__parser_8hpp_source.html">common/arg_parser.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="socket__utils_8hpp_source.html">common/socket_utils.hpp</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for main.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="server_2main_8cpp__incl.png" border="0" usemap="#asrc_2server_2main_8cpp" alt=""/></div>
<map name="asrc_2server_2main_8cpp" id="asrc_2server_2main_8cpp">
<area shape="rect" title="Scalable UDP echo server." alt="" coords="529,5,679,31"/>
<area shape="rect" title=" " alt="" coords="5,79,91,104"/>
<area shape="poly" title=" " alt="" coords="529,29,340,49,105,81,104,76,340,44,528,24"/>
<area shape="rect" title=" " alt="" coords="115,79,181,104"/>
<area shape="poly" title=" " alt="" coords="529,31,378,51,195,81,194,76,378,45,528,25"/>
<area shape="rect" title=" " alt="" coords="206,79,274,104"/>
<area shape="poly" title=" " alt="" coords="537,33,288,81,287,76,535,28"/>
<area shape="rect" title=" " alt="" coords="298,79,363,104"/>
<area shape="poly" title=" " alt="" coords="561,33,377,81,376,76,559,28"/>
<area shape="rect" title=" " alt="" coords="631,152,697,177"/>
<area shape="poly" title=" " alt="" coords="611,30,656,138,651,140,606,32"/>
<area shape="rect" title=" " alt="" coords="527,152,607,177"/>
<area shape="poly" title=" " alt="" coords="604,32,576,139,570,138,598,30"/>
<area shape="rect" title=" " alt="" coords="1060,79,1135,104"/>
<area shape="poly" title=" " alt="" coords="680,25,844,45,1047,76,1046,81,844,50,679,30"/>
<area shape="rect" title=" " alt="" coords="1159,79,1257,104"/>
<area shape="poly" title=" " alt="" coords="680,23,886,44,1145,76,1145,81,885,49,679,28"/>
<area shape="rect" title=" " alt="" coords="721,152,785,177"/>
<area shape="poly" title=" " alt="" coords="618,29,734,141,730,144,614,33"/>
<area shape="rect" href="arg__parser_8hpp.html" title="Lightweight command&#45;line argument parser used by client/server examples." alt="" coords="388,79,567,104"/>
<area shape="poly" title=" " alt="" coords="585,33,511,74,509,69,582,28"/>
<area shape="rect" href="socket__utils_8hpp.html" title="Cross&#45;cutting Win32 socket utilities and IOCP helpers used by the demo." alt="" coords="847,79,1035,104"/>
<area shape="poly" title=" " alt="" coords="659,28,874,73,873,78,658,33"/>
<area shape="poly" title=" " alt="" coords="493,102,543,141,540,145,490,106"/>
<area shape="rect" title=" " alt="" coords="265,152,332,177"/>
<area shape="poly" title=" " alt="" coords="450,107,341,149,339,144,448,102"/>
<area shape="rect" title=" " alt="" coords="79,152,129,177"/>
<area shape="poly" title=" " alt="" coords="398,107,281,126,143,155,142,149,280,121,397,101"/>
<area shape="rect" title=" " alt="" coords="154,152,241,177"/>
<area shape="poly" title=" " alt="" coords="433,107,255,152,253,146,432,101"/>
<area shape="rect" title=" " alt="" coords="444,152,503,177"/>
<area shape="poly" title=" " alt="" coords="479,104,477,139,472,138,474,104"/>
<area shape="rect" title=" " alt="" coords="357,152,419,177"/>
<area shape="poly" title=" " alt="" coords="465,106,415,145,412,141,461,102"/>
<area shape="poly" title=" " alt="" coords="897,107,711,154,710,149,896,101"/>
<area shape="poly" title=" " alt="" coords="876,107,621,154,620,149,875,101"/>
<area shape="poly" title=" " alt="" coords="912,107,798,149,796,144,910,102"/>
<area shape="poly" title=" " alt="" coords="847,105,696,124,517,155,516,149,695,119,847,100"/>
<area shape="poly" title=" " alt="" coords="847,102,660,121,433,155,432,150,659,116,847,97"/>
<area shape="rect" title=" " alt="" coords="894,152,989,177"/>
<area shape="poly" title=" " alt="" coords="944,104,944,138,939,138,939,104"/>
<area shape="rect" title=" " alt="" coords="1013,152,1107,177"/>
<area shape="poly" title=" " alt="" coords="962,102,1030,142,1027,147,959,106"/>
<area shape="rect" title=" " alt="" coords="1131,152,1245,177"/>
<area shape="poly" title=" " alt="" coords="982,101,1136,146,1134,151,980,107"/>
<area shape="rect" title=" " alt="" coords="1269,152,1360,177"/>
<area shape="poly" title=" " alt="" coords="1004,101,1256,149,1255,154,1003,107"/>
<area shape="rect" title=" " alt="" coords="1385,152,1477,177"/>
<area shape="poly" title=" " alt="" coords="1035,101,1372,149,1371,155,1034,107"/>
<area shape="rect" title=" " alt="" coords="1501,152,1568,177"/>
<area shape="poly" title=" " alt="" coords="1036,100,1488,150,1487,155,1035,105"/>
<area shape="rect" title=" " alt="" coords="1592,152,1659,177"/>
<area shape="poly" title=" " alt="" coords="1036,100,1048,101,1196,113,1312,119,1429,129,1579,149,1578,155,1429,134,1312,125,1195,118,1048,107,1035,105"/>
<area shape="rect" title=" " alt="" coords="1683,152,1770,177"/>
<area shape="poly" title=" " alt="" coords="1036,100,1048,101,1221,114,1357,121,1494,129,1670,149,1669,155,1494,135,1357,126,1221,119,1048,107,1035,105"/>
<area shape="rect" title=" " alt="" coords="1795,152,1872,177"/>
<area shape="poly" title=" " alt="" coords="1036,100,1048,101,1253,114,1413,118,1575,126,1781,149,1780,155,1574,132,1413,124,1252,119,1048,107,1035,106"/>
<area shape="rect" title=" " alt="" coords="1896,152,1971,177"/>
<area shape="poly" title=" " alt="" coords="1036,100,1048,101,1281,114,1464,117,1648,124,1756,134,1883,149,1882,155,1755,139,1648,130,1464,123,1281,120,1048,107,1035,106"/>
<area shape="rect" title=" " alt="" coords="810,152,870,177"/>
<area shape="poly" title=" " alt="" coords="927,106,869,146,866,142,924,102"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structserver__worker__context.html">server_worker_context</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Per-worker context for server-side processing.  <a href="structserver__worker__context.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8804db44b6d4c5752e6de5593562df06" id="r_a8804db44b6d4c5752e6de5593562df06"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_2main_8cpp.html#a8804db44b6d4c5752e6de5593562df06">signal_handler</a> (int)</td></tr>
<tr class="memdesc:a8804db44b6d4c5752e6de5593562df06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Signal handler that requests shutdown.  <br /></td></tr>
<tr class="separator:a8804db44b6d4c5752e6de5593562df06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22b88aa9bff98ff9514d5399440fcf3d" id="r_a22b88aa9bff98ff9514d5399440fcf3d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_2main_8cpp.html#a22b88aa9bff98ff9514d5399440fcf3d">worker_thread_func</a> (<a class="el" href="structserver__worker__context.html">server_worker_context</a> *ctx)</td></tr>
<tr class="memdesc:a22b88aa9bff98ff9514d5399440fcf3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Worker thread entrypoint for the server.  <br /></td></tr>
<tr class="separator:a22b88aa9bff98ff9514d5399440fcf3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51a7cb9294836368735548fe5ccea25d" id="r_a51a7cb9294836368735548fe5ccea25d"><td class="memTemplParams" colspan="2">template&lt;typename WorkerType &gt; </td></tr>
<tr class="memitem:a51a7cb9294836368735548fe5ccea25d"><td class="memTemplItemLeft" align="right" valign="top">std::thread&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="server_2main_8cpp.html#a51a7cb9294836368735548fe5ccea25d">create_rps_thread</a> (const std::vector&lt; std::unique_ptr&lt; WorkerType &gt; &gt; &amp;workers)</td></tr>
<tr class="memdesc:a51a7cb9294836368735548fe5ccea25d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Common template for RPS printer thread.  <br /></td></tr>
<tr class="separator:a51a7cb9294836368735548fe5ccea25d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a208a9d3dd13ad1117545642a14286acb" id="r_a208a9d3dd13ad1117545642a14286acb"><td class="memTemplParams" colspan="2">template&lt;typename WorkerType &gt; </td></tr>
<tr class="memitem:a208a9d3dd13ad1117545642a14286acb"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="server_2main_8cpp.html#a208a9d3dd13ad1117545642a14286acb">print_final_stats</a> (const std::vector&lt; std::unique_ptr&lt; WorkerType &gt; &gt; &amp;workers)</td></tr>
<tr class="memdesc:a208a9d3dd13ad1117545642a14286acb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Common template for printing final stats.  <br /></td></tr>
<tr class="separator:a208a9d3dd13ad1117545642a14286acb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a96877777922b6735de24943700de12" id="r_a5a96877777922b6735de24943700de12"><td class="memTemplParams" colspan="2">template&lt;typename WorkerType &gt; </td></tr>
<tr class="memitem:a5a96877777922b6735de24943700de12"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="server_2main_8cpp.html#a5a96877777922b6735de24943700de12">cleanup_workers</a> (std::vector&lt; std::unique_ptr&lt; WorkerType &gt; &gt; &amp;workers)</td></tr>
<tr class="memdesc:a5a96877777922b6735de24943700de12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Common template for joining and cleanup of worker threads.  <br /></td></tr>
<tr class="separator:a5a96877777922b6735de24943700de12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8212a16f43577870064009196a9b53a" id="r_af8212a16f43577870064009196a9b53a"><td class="memTemplParams" colspan="2">template&lt;typename WorkerType &gt; </td></tr>
<tr class="memitem:af8212a16f43577870064009196a9b53a"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="server_2main_8cpp.html#af8212a16f43577870064009196a9b53a">close_iocps</a> (std::vector&lt; std::unique_ptr&lt; WorkerType &gt; &gt; &amp;workers)</td></tr>
<tr class="memdesc:af8212a16f43577870064009196a9b53a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close all IOCPs to wake up worker threads. Works for IOCP-based worker contexts only.  <br /></td></tr>
<tr class="separator:af8212a16f43577870064009196a9b53a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97" id="r_a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_2main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="memdesc:a0ddf1224851353fc92bfbff6f499fa97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Program entry point for the server.  <br /></td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab5c49e0b28b36cdb5ccc5a994e16ab4c" id="r_ab5c49e0b28b36cdb5ccc5a994e16ab4c"><td class="memItemLeft" align="right" valign="top">std::atomic&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_2main_8cpp.html#ab5c49e0b28b36cdb5ccc5a994e16ab4c">g_shutdown</a> {false}</td></tr>
<tr class="separator:ab5c49e0b28b36cdb5ccc5a994e16ab4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac980a9bd470a1372b5641f0db30ac7ca" id="r_ac980a9bd470a1372b5641f0db30ac7ca"><td class="memItemLeft" align="right" valign="top">std::atomic&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_2main_8cpp.html#ac980a9bd470a1372b5641f0db30ac7ca">g_verbose</a> {false}</td></tr>
<tr class="separator:ac980a9bd470a1372b5641f0db30ac7ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02557e9f43fc7426141adbd5b54fb204" id="r_a02557e9f43fc7426141adbd5b54fb204"><td class="memItemLeft" align="right" valign="top">std::atomic&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="server_2main_8cpp.html#a02557e9f43fc7426141adbd5b54fb204">g_sync_reply</a> {false}</td></tr>
<tr class="separator:a02557e9f43fc7426141adbd5b54fb204"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Scalable UDP echo server. </p>
<p>The server creates one listening UDP socket per CPU (for both IPv4 and IPv6), affinitizes sockets and worker threads to processors, and uses IO Completion Ports to efficiently process incoming datagrams and echo responses back to clients.</p>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2025 WinUDPShardedEcho Contributors SPDX-License-Identifier: MIT </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a5a96877777922b6735de24943700de12" name="a5a96877777922b6735de24943700de12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a96877777922b6735de24943700de12">&#9670;&#160;</a></span>cleanup_workers()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename WorkerType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void cleanup_workers </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::unique_ptr&lt; WorkerType &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>workers</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Common template for joining and cleanup of worker threads. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">WorkerType</td><td>IOCP worker context type </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af8212a16f43577870064009196a9b53a" name="af8212a16f43577870064009196a9b53a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8212a16f43577870064009196a9b53a">&#9670;&#160;</a></span>close_iocps()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename WorkerType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void close_iocps </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::unique_ptr&lt; WorkerType &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>workers</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close all IOCPs to wake up worker threads. Works for IOCP-based worker contexts only. </p>

</div>
</div>
<a id="a51a7cb9294836368735548fe5ccea25d" name="a51a7cb9294836368735548fe5ccea25d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51a7cb9294836368735548fe5ccea25d">&#9670;&#160;</a></span>create_rps_thread()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename WorkerType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::thread create_rps_thread </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::unique_ptr&lt; WorkerType &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>workers</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Common template for RPS printer thread. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">WorkerType</td><td>IOCP worker context type </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0ddf1224851353fc92bfbff6f499fa97" name="a0ddf1224851353fc92bfbff6f499fa97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddf1224851353fc92bfbff6f499fa97">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Program entry point for the server. </p>
<p>Parses options, initializes Winsock, creates worker contexts for IPv4/IPv6 on each CPU, starts threads and prints aggregated statistics on shutdown. </p>

</div>
</div>
<a id="a208a9d3dd13ad1117545642a14286acb" name="a208a9d3dd13ad1117545642a14286acb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a208a9d3dd13ad1117545642a14286acb">&#9670;&#160;</a></span>print_final_stats()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename WorkerType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void print_final_stats </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::unique_ptr&lt; WorkerType &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>workers</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Common template for printing final stats. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">WorkerType</td><td>IOCP worker context type </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8804db44b6d4c5752e6de5593562df06" name="a8804db44b6d4c5752e6de5593562df06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8804db44b6d4c5752e6de5593562df06">&#9670;&#160;</a></span>signal_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void signal_handler </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Signal handler that requests shutdown. </p>

</div>
</div>
<a id="a22b88aa9bff98ff9514d5399440fcf3d" name="a22b88aa9bff98ff9514d5399440fcf3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22b88aa9bff98ff9514d5399440fcf3d">&#9670;&#160;</a></span>worker_thread_func()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void worker_thread_func </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structserver__worker__context.html">server_worker_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Worker thread entrypoint for the server. </p>
<p>Pins the thread, posts initial receives, and loops processing IOCP completions for receives and sends. Received datagrams are echoed back to the sender in this example. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab5c49e0b28b36cdb5ccc5a994e16ab4c" name="ab5c49e0b28b36cdb5ccc5a994e16ab4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5c49e0b28b36cdb5ccc5a994e16ab4c">&#9670;&#160;</a></span>g_shutdown</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic&lt;bool&gt; g_shutdown {false}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a02557e9f43fc7426141adbd5b54fb204" name="a02557e9f43fc7426141adbd5b54fb204"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02557e9f43fc7426141adbd5b54fb204">&#9670;&#160;</a></span>g_sync_reply</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic&lt;bool&gt; g_sync_reply {false}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac980a9bd470a1372b5641f0db30ac7ca" name="ac980a9bd470a1372b5641f0db30ac7ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac980a9bd470a1372b5641f0db30ac7ca">&#9670;&#160;</a></span>g_verbose</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic&lt;bool&gt; g_verbose {false}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_075bb3ff235063c77951cd176d15a741.html">server</a></li><li class="navelem"><a class="el" href="server_2main_8cpp.html">main.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
